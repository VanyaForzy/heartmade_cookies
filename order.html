<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Äî HeartMade Cookies</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<header>
  <h1>üç™ HeartMade Cookies</h1>
  <nav>
    <a href="index.html">–ì–æ–ª–æ–≤–Ω–∞</a>
    <a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a>
    <a href="about.html">–ü—Ä–æ –Ω–∞—Å</a>
    <a href="contact.html">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a>
    <a href="cart.html">üõí –ö–æ—à–∏–∫</a>
    <a href="my-orders.html">üì¶ –ú–æ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
  </nav>
</header>

<section class="order-section">
  <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>

  <div id="order-cart"></div>

  <form id="order-form" action="https://formsubmit.co/heartmadecookies4@gmail.com" method="POST">
    
    <input type="hidden" name="_subject" value="–ù–æ–≤–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑ HeartMade Cookies!">
    <input type="hidden" name="_captcha" value="false">
    <input type="hidden" name="cart_data" id="cart-data">

    <label>–Ü–º‚Äô—è:
      <input type="text" name="name" required>
    </label>

    <label>–¢–µ–ª–µ—Ñ–æ–Ω:
      <input type="tel" name="phone" required>
    </label>

    <label>–ê–¥—Ä–µ—Å–∞ (—Å–∞–º–æ–≤–∏–≤—ñ–∑ ‚Äî –∑–∞–ª–∏—à –ø–æ—Ä–æ–∂–Ω—å–æ):
      <input type="text" name="address">
    </label>

    <button type="submit" class="btn">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
  </form>

  <p id="order-result"></p>
</section>

<footer>
  <p>¬© 2025 HeartMade Cookies | –ó –ª—é–±–æ–≤‚Äô—é –∑—Ä–æ–±–ª–µ–Ω–æ –≤–¥–æ–º–∞ üíõ</p>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const orderCart = document.getElementById("order-cart");
  const cartField = document.getElementById("cart-data");
  const form = document.getElementById("order-form");

  const cart = JSON.parse(localStorage.getItem("cart")) || [];

  let total = 0;

  // ======= –ü–æ–∫–∞–∑ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ =======
  if (cart.length === 0) {
    orderCart.innerHTML = "<p>–í–∞—à –∫–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π üò¢</p>";
  } else {

    cart.forEach(item => {
      const div = document.createElement("div");
      div.classList.add("cart-item");

      if (item.name === "HeartBox") {
        const list = item.items || item.cookies || [];

        div.innerHTML = `
          <h3>HeartBox (4 —à—Ç)</h3>
          <p><strong>–°–∫–ª–∞–¥:</strong> ${list.length ? list.join(", ") : "–ù–µ –≤–∏–±—Ä–∞–Ω–æ"}</p>
          <p>${item.price} –≥—Ä–Ω √ó ${item.qty}</p>
        `;
      } else {
        div.innerHTML = `
          <h3>${item.name}</h3>
          <p>${item.price} –≥—Ä–Ω √ó ${item.qty}</p>
        `;
      }

      orderCart.appendChild(div);
      total += item.price * item.qty;
    });

    orderCart.innerHTML += `<h3>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: ${total} –≥—Ä–Ω</h3>`;
  }

  // ======= –°–∞–±–º—ñ—Ç –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è =======
  form.addEventListener("submit", function(e) {
    e.preventDefault();

    if (cart.length === 0) {
      alert("–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π!");
      return;
    }

    const name = form.querySelector("input[name='name']").value;
    const phone = form.querySelector("input[name='phone']").value;
    const address = form.querySelector("input[name='address']").value || "–°–∞–º–æ–≤–∏–≤—ñ–∑";

    // ======= –¢–µ–∫—Å—Ç –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è –ø–æ—à—Ç–∏ =======
    const formatted = cart.map(item => {
      if (item.name === "HeartBox" && Array.isArray(item.items)) {
        return `HeartBox: ${item.items.join(", ")}`;
      }
      return `${item.name} √ó ${item.qty}`;
    }).join("\n");

    cartField.value = formatted + `\n\n–°—É–º–∞: ${total} –≥—Ä–Ω`;

    // ======= –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ "–ú–æ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è" =======
    const myOrders = JSON.parse(localStorage.getItem("MY_ORDERS")) || [];

    myOrders.push({
      name,
      phone,
      address,
      items: cart,
      total,
      date: new Date().toLocaleString()
    });

    localStorage.setItem("MY_ORDERS", JSON.stringify(myOrders));

    // ======= –û—á–∏—â–∞—î–º–æ –∫–æ—à–∏–∫ =======
    localStorage.removeItem("cart");
    localStorage.removeItem("checkout_cart");

    document.getElementById("order-result").innerHTML = 
      "‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ! –ó–∞—Ä–∞–∑ –≤–æ–Ω–æ –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –Ω–∞ –ø–æ—à—Ç—É.";

    // ======= –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏ –Ω–∞ –ø–æ—à—Ç—É =======
    setTimeout(() => {
      form.submit();
    }, 400);
  });

});
</script>

</body>
</html>
